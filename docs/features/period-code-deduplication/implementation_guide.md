# ChatMe Flutter App Implementation Guide

This guide provides step-by-step instructions for implementing a Flutter app that connects to your Laravel backend and receives real-time notifications.

## Overview

The Flutter app will:
1. Connect to your Laravel backend using API endpoints
2. Authenticate users using Laravel Sanctum
3. Receive real-time notifications via Firebase Cloud Messaging
4. Display chat messages and notifications
5. Run in the background to ensure notifications are received

## Implementation Steps

### 1. Set Up Firebase Cloud Messaging in Laravel

First, follow the instructions in `laravel_fcm_setup.md` to set up Firebase Cloud Messaging in your Laravel project. This includes:

- Installing required packages
- Setting up Firebase credentials
- Creating necessary models and controllers
- Adding API endpoints for device token management

### 2. Create a New Flutter Project

Follow these steps to create a new Flutter project:

```bash
# Create a new Flutter project
flutter create chatme_app

# Navigate to the project directory
cd chatme_app

# Install dependencies (after updating pubspec.yaml)
flutter pub get
```

### 3. Configure Firebase for Flutter

Follow the instructions in `flutter_fcm_setup.md` to set up Firebase in your Flutter app. This includes:

- Installing FlutterFire CLI
- Configuring Firebase for your app
- Setting up Android and iOS configurations

### 4. Implement the Flutter App

Follow the structure outlined in `flutter_app_structure.md` to implement the Flutter app. The key files to create are:

1. **Configuration Files**
   - `lib/firebase_options.dart` (generated by FlutterFire CLI)
   - `lib/config/api_config.dart`
   - `lib/config/app_config.dart`

2. **Model Classes**
   - `lib/models/user_model.dart`
   - `lib/models/notification_model.dart`
   - `lib/models/chat_message_model.dart`

3. **Service Classes**
   - `lib/services/auth_service.dart`
   - `lib/services/api_service.dart`
   - `lib/services/notification_service.dart`
   - `lib/services/chat_service.dart`

4. **UI Screens**
   - `lib/screens/login_screen.dart`
   - `lib/screens/home_screen.dart`
   - `lib/screens/chat_screen.dart`
   - `lib/screens/notification_screen.dart`

5. **Widgets**
   - `lib/widgets/chat_bubble.dart`
   - `lib/widgets/loading_indicator.dart`

6. **Main App Entry Point**
   - `lib/main.dart`

### 5. Testing the App

1. **Run the Laravel Backend**
   ```bash
   cd /path/to/laravel/project
   php artisan serve --host=0.0.0.0
   ```

2. **Run the Flutter App**
   ```bash
   cd /path/to/flutter/project
   flutter run
   ```

3. **Test Notifications**
   - Send a test notification from the Laravel backend
   - Verify that the notification is received in the Flutter app

## Key Features Implementation

### Authentication

The app uses Laravel Sanctum for authentication. The `AuthService` class handles:

- Login/logout functionality
- Token storage using `flutter_secure_storage`
- User profile retrieval
- Device token registration

### Real-time Notifications

The app uses Firebase Cloud Messaging for real-time notifications. The `NotificationService` class handles:

- FCM token management
- Foreground notification display using `flutter_local_notifications`
- Background notification handling
- Notification storage and retrieval

### Chat Functionality

The app connects to your Laravel chat system. The `ChatService` class handles:

- Retrieving conversations and messages
- Sending messages
- Real-time message updates using Firebase Realtime Database

## Background Processing

To ensure the app receives notifications even when in the background:

1. **Android Configuration**
   - The app is configured to receive Firebase messages in the background
   - A notification channel is created for high-importance notifications

2. **iOS Configuration**
   - Background modes are enabled in the Info.plist file
   - The app is configured to handle remote notifications

## Customization Options

### App Appearance

You can customize the app's appearance by modifying:

- The theme in `lib/main.dart`
- The colors in `lib/config/app_config.dart`
- The UI components in the screen files

### API Endpoints

You can customize the API endpoints by modifying:

- The base URL in `lib/config/api_config.dart`
- The endpoint paths in the same file

### Firebase Configuration

You can customize the Firebase configuration by:

- Updating the Firebase project settings in Firebase Console
- Regenerating the `firebase_options.dart` file using FlutterFire CLI

## Troubleshooting

### Common Issues

1. **Authentication Issues**
   - Ensure your Laravel Sanctum configuration is correct
   - Check that the API endpoints are accessible from the device

2. **Notification Issues**
   - Verify that Firebase is properly configured
   - Check that the device token is registered with your Laravel backend
   - Ensure background notifications are enabled in the app

3. **API Connection Issues**
   - Check that the base URL is correct and accessible
   - Verify that your Laravel app is running and accessible from the device

### Debugging Tools

1. **Firebase Console**
   - Use the Firebase Console to monitor FCM message delivery
   - Check for any errors in the Firebase logs

2. **Flutter DevTools**
   - Use Flutter DevTools to debug the app
   - Monitor network requests and responses

3. **Laravel Logs**
   - Check the Laravel logs for any API or FCM-related errors

## Next Steps

After implementing the basic app, consider these enhancements:

1. **Offline Support**
   - Implement caching for messages and conversations
   - Add offline message queuing

2. **Push Notification Customization**
   - Add notification categories
   - Implement notification actions

3. **UI Enhancements**
   - Add animations
   - Implement dark mode
   - Add localization support

4. **Security Enhancements**
   - Implement biometric authentication
   - Add end-to-end encryption for messages

5. **Performance Optimization**
   - Implement pagination for messages and conversations
   - Optimize image loading and caching
